import React, { useState } from 'react';

const WishingLanterns = () => {
  const [wish, setWish] = useState('');
  const [lanterns, setLanterns] = useState([]);
  const [showAnimation, setShowAnimation] = useState(false);

  const handleWish = (e) => {
    e.preventDefault();
    if (!wish.trim()) return;
    
    const newLantern = {
      id: Date.now(),
      text: wish,
      left: Math.random() * 80 + 10,
      delay: Math.random() * 2
    };
    
    setLanterns([...lanterns, newLantern]);
    setWish('');
    setShowAnimation(true);
    setTimeout(() => setShowAnimation(false), 1000);
  };

  return (
    <div className="relative h-screen overflow-hidden bg-gradient-to-b from-gray-900 via-purple-900 to-violet-900">
      {/* 星星背景 */}
      {[...Array(50)].map((_, i) => (
        <div
          key={i}
          className="absolute w-1 h-1 bg-white rounded-full animate-twinkle"
          style={{
            left: `${Math.random() * 100}%`,
            top: `${Math.random() * 100}%`,
            animationDelay: `${Math.random() * 3}s`
          }}
        />
      ))}

      {/* 明月 */}
      <div className="absolute w-32 h-32 rounded-full bg-yellow-100 top-10 right-20 shadow-2xl" 
           style={{boxShadow: '0 0 50px rgba(255, 248, 220, 0.8)'}} />

      {/* 孔明灯 */}
      {lanterns.map(lantern => (
        <div
          key={lantern.id}
          className="absolute animate-float"
          style={{
            left: `${lantern.left}%`,
            animationDelay: `${lantern.delay}s`
          }}
        >
          <div className="relative w-20 h-28">
            <div className="absolute w-full h-20 bg-orange-100 rounded-t-full opacity-60" />
            <div className="absolute bottom-0 w-full h-8 bg-orange-200 rounded-b-lg opacity-60" />
            <div className="absolute w-full h-full flex items-center justify-center p-4 text-center">
              <p className="text-xs text-gray-800 break-words">
                {lantern.text}
              </p>
            </div>
          </div>
        </div>
      ))}

      {/* 输入框 */}
      <div className="absolute bottom-20 left-1/2 transform -translate-x-1/2 w-64">
        <form onSubmit={handleWish} className="flex flex-col items-center gap-4">
          <input
            type="text"
            value={wish}
            onChange={(e) => setWish(e.target.value)}
            placeholder="写下你的愿望..."
            className="w-full px-4 py-2 rounded-lg bg-white/20 backdrop-blur-sm text-white placeholder-gray-300 border border-white/30 focus:outline-none focus:ring-2 focus:ring-white/50"
            maxLength={50}
          />
          <button
            type="submit"
            className={`px-6 py-2 rounded-full bg-white/20 backdrop-blur-sm text-white border border-white/30 hover:bg-white/30 transition-all ${
              showAnimation ? 'animate-pulse' : ''
            }`}
          >
            放飞愿望
          </button>
        </form>
      </div>
    </div>
  );
};

export default WishingLanterns;
